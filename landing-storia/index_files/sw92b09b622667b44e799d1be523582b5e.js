var IndexClass=BaseClass.extend({init:function(){this._super();this.initGeosuggest();this.initPromoted();this.initArticles()},initGeosuggest:function(){$('#search-location').geosuggest({distancePicker:$('#search-distance'),showPopularLocations:true,allowClear:true,levels:['REGION','SUBREGION','CITY','DISTRICT','STREET'],showSearchInDescriptionsButton:true})},initPromoted:function(){var thiz=this;$(window).off('resize.promoted').on('resize.promoted',Main.debounce(thiz.checkPromoted,200));thiz.checkPromoted()},checkPromoted:function(){var $el=$('#carousel-promoted'),isMobile=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0)<768;if(!$el.carousel&&isMobile){$el.carousel();return};if(isMobile){$el.removeClass('carousel-disabled').carousel('cycle')}else $el.addClass('carousel-disabled').carousel('pause')},initArticles:function(){$('[data-atlas-slider]').atlasSlider()}});$().ready(function(){new IndexClass()});$(function(){'use strict';var defaultTouchPointPage='home'
function defaultLinkCallback(){var href=this.selector.attr('href');return function(){window.location.href=href}};$('#carousel-promoted .offer-photo-box').trackNinja('click',{params:{trackLinkEvent:['ad_click'],action_type:'ad_click',event_type:'click',touch_point_page:defaultTouchPointPage,touch_point_button:"featured_ad",ad_id:null,linkCallBack:defaultLinkCallback}});$('.featured-list .item-options a').trackNinja('click',{params:{trackLinkEvent:['home_category_click'],action_type:'home_category_click',event_type:'click',cat_l1_id:null,cat_l1_name:null,business:null,linkCallBack:defaultLinkCallback}});$('.section-main-promoted .btn-all').trackNinja('click',{params:{trackLinkEvent:['see_all_promoted_ads'],action_type:'see_all_promoted_ads',event_type:'click',touch_point_page:defaultTouchPointPage,linkCallBack:defaultLinkCallback}});$('.form-search .btn-search-big').trackNinja('click',{params:{trackLinkEvent:['search'],action_type:'search',event_type:'click',touch_point_page:defaultTouchPointPage,linkCallBack:function(){var form=this.selector.closest('form');return function(){form.submit()}}}})});var TouchHandler=(function($){var triggerEventNS='.th',events={start:'touchstart.th mousedown.th',end:'touchend.th mouseup.th',move:'touchmove.th mousemove.th',click:'click.th touchend.th'},styleProperty='transform',$currentTarget,startX,endX,movement,minimalMovement=50,RIGHT='right',LEFT='left',isChildClickable=true,regexMatrix=/([+-]?[\d]{1,})/g;$(window).on(events.end,handleTouchEnd)
function handleTouchStart(e){$currentTarget=$(this);startX=getEventX(e);startElX=getPropertyValue();endX=0;turnOnListeningMovements();isChildClickable=true}
function handleTouchMove(e){if($currentTarget){endX=getEventX(e)-startX;if(endX>minimalMovement){movement=RIGHT}else if(endX<-minimalMovement)movement=LEFT;isChildClickable=false;$currentTarget.css(styleProperty,'translateX('+(endX+startElX)+'px)')};if(!!movement||e.type==='mousemove')e.preventDefault()}
function getEventX(e){return e.clientX||(e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0].clientX:0)}
function handleTouchEnd(e){if($currentTarget)if(movement){e.preventDefault();$currentTarget.trigger('move'+movement+triggerEventNS,endX)}else $currentTarget.css(styleProperty,'translateX('+startElX+'px)');$currentTarget=null;isChildClickable=!movement;movement=null;turnOffListeningMovements()}
function handleClickChild(e){if(!isChildClickable)e.preventDefault();isChildClickable=true}
function turnOnListeningMovements(){$(window).off(events.move).on(events.move,handleTouchMove)}
function turnOffListeningMovements(){$(window).off(events.move)}
function addTarget(el){$(el).on(events.start,handleTouchStart).children().on(events.click,handleClickChild)}
function removeTarget(el){$(el).off(events.start).children().off(events.click)}
function getPropertyValue(){var propertyValue=$currentTarget.css(styleProperty),value=parseFloat(propertyValue),aux;if(isNaN(value)&&!!~propertyValue.indexOf('matrix')){aux=propertyValue.match(regexMatrix);value=parseFloat(aux[4])};return value};return{addTarget:addTarget,removeTarget:removeTarget}})(jQuery);(function($){'use strict';var AtlasSlider=window.AtlasSlider||{};AtlasSlider=(function(){function AtlasSlider(el,params){var _=this;_.pluginName='atlas-slider';_.$el=$(el);_.$items=_.$el.children('[data-'+_.pluginName+'-item]');_.$container=$('<div class="'+_.pluginName+'-container"></div>');_.$content=$('<div class="'+_.pluginName+'-content"></div>');_.$prev=_.$el.find('[data-'+_.pluginName+'-prev]');_.$next=_.$el.find('[data-'+_.pluginName+'-next]');_.containerWidth=0;_.contentWidth=0;_.itemWidth=0;_.itemsPerPage=0;_.minPage=0;_.maxPage=0;_.currentPage=params.page||0;_.pageWidth=0;_.$container.data(_.pluginName+'-page',_.currentPage);_.$items.addClass(_.pluginName+'-item');_.$el.append([_.$container,_.$prev,_.$next]);_.$container.append(_.$content);_.$content.append(_.$items);_.bindEvents=$.proxy(_.bindEvents,_);_.resetVars=$.proxy(_.resetVars,_);_.getCurrentPage=$.proxy(_.getCurrentPage,_);_.setItemVisible=$.proxy(_.setItemVisible,_);_.next=$.proxy(_.next,_);_.prev=$.proxy(_.prev,_);_.move=$.proxy(_.move,_);_.goto=$.proxy(_.goto,_);_.bindEvents();_.resetVars()};return AtlasSlider}());AtlasSlider.prototype.resetVars=function(){var _=this;_.itemWidth=_.$items.outerWidth(true);_.contentWidth=_.itemWidth*_.$items.length;_.containerWidth=_.$container.width();_.itemsPerPage=parseInt(_.containerWidth/_.itemWidth,10);_.pageWidth=_.itemsPerPage*_.itemWidth;_.minPage=0;_.maxPage=(_.contentWidth<=_.containerWidth)?0:_.$items.length/_.itemsPerPage-1;_.currentPage=_.getCurrentPage();_.move(_.currentPage);_.setupTouchEvents()};AtlasSlider.prototype.getCurrentPage=function(page){var _=this;page=parseInt(page,10);page=!isNaN(page)?page:parseInt(_.$container.data(_.pluginName+'-page'),10);if(page>=_.maxPage){page=_.maxPage}else if(page<_.minPage)page=_.minPage;return page};AtlasSlider.prototype.setupTouchEvents=function(){var _=this;if(!!_.maxPage){TouchHandler.addTarget(_.$content)}else TouchHandler.removeTarget(_.$content)};AtlasSlider.prototype.bindEvents=function(){var _=this;_.setupTouchEvents();_.$el.on('goto',_.goto);_.$el.on('setItemVisible',_.setItemVisible);_.$content.on('moveleft.th',_.next);_.$content.on('moveright.th',_.prev);_.$prev.on('click',_.prev);_.$next.on('click',_.next);$(window).on('resetVars',_.resetVars);$(window).on('resize',Main.debounce(_.resetVars,200))};AtlasSlider.prototype.next=function(e){e.preventDefault();e.stopPropagation();this.move(this.currentPage+1)};AtlasSlider.prototype.prev=function(e){e.preventDefault();e.stopPropagation();this.move(this.currentPage-1)};AtlasSlider.prototype.goto=function(e,page){this.move(page)};AtlasSlider.prototype.setItemVisible=function(e,item){e.preventDefault();var _=this,page=_.currentPage,itemPage=Math.ceil((item+1)/_.itemsPerPage,10)-1;if(page>itemPage){_.move(page-1)}else if(page<itemPage)_.move(page+1)};AtlasSlider.prototype.getPagePosition=function(){var _=this,_position=_.currentPage*_.pageWidth;if(!!_.currentPage&&_.currentPage===_.maxPage)_position=_.contentWidth-_.containerWidth;return _position*-1};AtlasSlider.prototype.setButtonsVisibility=function(){var _=this;_.$prev.toggleClass('hidden',_.currentPage==0);_.$next.toggleClass('hidden',_.currentPage==_.maxPage||_.maxPage==0)};AtlasSlider.prototype.move=function(page){var _=this;_.currentPage=_.getCurrentPage(page);_.$container.data(_.pluginName+'-page',_.currentPage);_.$content.css('transform','translateX('+_.getPagePosition()+'px)');_.setButtonsVisibility();_.$container.trigger('move',_.currentPage)};$.fn.atlasSlider=function AtlasSliderSetup(params){params=params||{};return this.each(function(i,el){new AtlasSlider(el,params)})}})(jQuery);